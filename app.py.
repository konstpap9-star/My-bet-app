import streamlit as st
import itertools

# --- Î¡Î¥Î˜ÎœÎ™Î£Î•Î™Î£ ---
st.set_page_config(page_title="BigBet Tool", layout="centered")
PASSWORD = "Î¿_ÎºÏ‰Î´Î¹ÎºÏŒÏ‚_ÏƒÎ¿Ï…" # Î‘Î›Î›Î‘ÎÎ• Î¤ÎŸ

# --- Î•Î›Î•Î“Î§ÎŸÎ£ Î Î¡ÎŸÎ£Î’Î‘Î£Î—Î£ ---
if "login" not in st.session_state:
    st.session_state.login = False

if not st.session_state.login:
    st.header("ğŸ”’ Î•Î¯ÏƒÎ¿Î´Î¿Ï‚")
    user_pass = st.text_input("ÎšÏ‰Î´Î¹ÎºÏŒÏ‚", type="password")
    if st.button("Î•Î¯ÏƒÎ¿Î´Î¿Ï‚"):
        if user_pass == PASSWORD:
            st.session_state.login = True
            st.rerun()
        else:
            st.error("Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚")
    st.stop()

# --- ÎšÎ¥Î¡Î™Î©Î£ Î•Î¦Î‘Î¡ÎœÎŸÎ“Î— ---
st.title("âš½ My Private Betting App")

# 1. Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Î‘Î³ÏÎ½Ï‰Î½
st.header("1. Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î‘Î³ÏÎ½Ï‰Î½")
input_data = st.text_area("Î“ÏÎ¬ÏˆÎµ Ï„Î¿Ï…Ï‚ Î±Î³ÏÎ½ÎµÏ‚ (Î­Î½Î±Î½ ÏƒÎµ ÎºÎ¬Î¸Îµ Î³ÏÎ±Î¼Î¼Î®)", 
                         placeholder="Ï€.Ï‡. ÎŸÎ»Ï…Î¼Ï€Î¹Î±ÎºÏŒÏ‚-Î Î‘ÎŸÎš")

# 2. Î•Ï€Î¹Î»Î¿Î³Î® Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚
if input_data:
    matches = input_data.split('\n')
    matches = [m.strip() for m in matches if m.strip()]
    
    st.header("2. Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î£Ï…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚")
    k = st.number_input("Î£ÏÏƒÏ„Î·Î¼Î± (Ï€.Ï‡. 3Î¬Î´ÎµÏ‚, 4Î¬Î´ÎµÏ‚)", min_value=1, max_value=len(matches), value=min(3, len(matches)))
    
    if st.button("Î‘Î½Î¬Ï€Ï„Ï…Î¾Î· Î£Ï„Î·Î»ÏÎ½"):
        all_combinations = list(itertools.combinations(matches, k))
        
        st.success(f"Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎ±Î½ {len(all_combinations)} ÏƒÏ„Î®Î»ÎµÏ‚")
        
        # Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÏƒÏ„Î·Î»ÏÎ½
        txt_output = ""
        for i, combo in enumerate(all_combinations, 1):
            st_text = f"Î£Ï„Î®Î»Î· {i}: {' - '.join(combo)}"
            st.write(st_text)
            txt_output += st_text + "\n"
        
        # ÎšÎ¿Ï…Î¼Ï€Î¯ Î³Î¹Î± Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ·
        st.download_button("ğŸ“„ Î›Î®ÏˆÎ· Î³Î¹Î± Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ·", txt_output, file_name="stiles.txt")
